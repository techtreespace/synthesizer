<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DIY ì•„ë‚ ë¡œê·¸ ì‹ ë””ì‚¬ì´ì € íƒí—˜</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f0f0; /* Light gray background */
            /* ëª¨ë°”ì¼ í…ìŠ¤íŠ¸ í¬ê¸° ì¡°ì •ì„ ìœ„í•œ ê¸°ë³¸ í°íŠ¸ í¬ê¸° ì„¤ì • */
            @apply text-base sm:text-lg;
        }
        .tab-button {
            @apply px-4 py-2 font-semibold rounded-t-lg transition-colors duration-200 ease-in-out;
        }
        .tab-button.active {
            @apply bg-sky-600 text-white;
        }
        .tab-button:not(.active) {
            @apply text-sky-700 bg-sky-100 hover:bg-sky-200;
        }
        .content-section {
            /* ê¸°ì¡´ min-h-[400px] ì œê±°, flex-growì™€ overflow-y-auto ì¶”ê°€ */
            @apply p-6 bg-white rounded-b-lg rounded-tr-lg shadow-lg flex-grow overflow-y-auto flex flex-col;
        }
        .interactive-box {
            @apply border-2 border-dashed border-amber-500 p-4 rounded-lg mt-4 text-center;
        }
        .component-card {
            @apply bg-stone-100 p-4 rounded-lg shadow hover:shadow-md transition-shadow;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 200px;
            max-height: 250px;
            background-color: #f0f0f0;
            border-radius: 0.5rem;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 250px;
            }
        }
        /* ì¶”ê°€ëœ CSS: í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€ */
        .synth-button, #tactSwitchDemo {
            -webkit-user-select: none; /* Safari */
            -ms-user-select: none; /* IE 10+ */
            user-select: none; /* Standard syntax */
            touch-action: manipulation; /* í„°ì¹˜ ì´ë²¤íŠ¸ ìµœì í™”: íƒ­ ì§€ì—° ì œê±° ë° í™•ëŒ€/í™•ëŒ€ ë°©ì§€ */
        }
        /* ê±´ë°˜ ë²„íŠ¼ í¬ê¸° ê³ ì • ë° ë‚´ìš© ì¤‘ì•™ ì •ë ¬ - ìˆ˜ì •ë¨ */
        .synth-button {
            /* ëª¨ë°”ì¼ ê¸°ë³¸ í¬ê¸°ë¥¼ 2ë°° í‚¤ì›€*/
            @apply min-w-[8rem] h-32 text-3xl
                   sm:min-w-[9rem] sm:h-36 sm:text-4xl
                   md:min-w-[10rem] md:h-40 md:text-5xl
                   lg:min-w-[12rem] lg:h-48 lg:text-6xl
                   flex items-center justify-center text-white font-bold;
            flex-shrink: 0;
            background-image: linear-gradient(to bottom, #d1d5db, #6b7280);
        }
        /* Heart section canvas styling */
        .heart-canvas-container {
            height: 100px; /* Fixed height for animation canvases */
            width: 100%;
            background-color: #e0f2fe; /* Light blue background for clarity */
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden; /* Ensure waves don't overflow */
        }

        /* Mobile navigation overlay styles */
        .mobile-nav-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9); /* Semi-transparent black background */
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            transform: translateX(100%); /* Start off-screen to the right */
            transition: transform 0.3s ease-in-out; /* Smooth transition */
        }

        .mobile-nav-overlay.open {
            transform: translateX(0); /* Slide in */
        }

        .mobile-nav-overlay .close-btn {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            font-size: 2rem;
            cursor: pointer;
            color: white;
        }

        .mobile-nav-overlay .nav-links {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            width: 100%; /* Take full width */
            align-items: flex-start; /* Align items to the left */
            padding-left: 2rem; /* Add left padding */
        }

        .mobile-nav-overlay .nav-links .tab-button {
            @apply text-white text-2xl bg-transparent hover:bg-sky-700 rounded-lg py-3 px-6;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2); /* Add subtle separator */
            text-align: left; /* Ensure text is left-aligned */
            width: 100%; /* Ensure button takes full width of its container */
        }
        .mobile-nav-overlay .nav-links .tab-button:last-child {
            border-bottom: none;
        }

        /* Main Page Overlay styles */
        #main-page-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #1e3a8a; /* Dark blue background */
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem; /* Default padding for all screens */
            text-align: center;
            z-index: 2000; /* Ensure it's on top of everything */
            transition: opacity 0.5s ease-in-out;
            opacity: 1;
            visibility: visible;
            /* Added for better mobile spacing */
            @apply px-4 sm:px-8 md:px-16; /* More responsive horizontal padding */
        }
        #main-page-overlay.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none; /* Prevent interaction when hidden */
        }
        #main-page-overlay h2 { /* Changed to be smaller, for "Welcome to" */
            @apply text-4xl sm:text-5xl font-extrabold mb-4 leading-tight; /* Increased font size */
        }
        #main-page-overlay h1 { /* New style for "DIY Analog Synthesizer" */
            @apply text-6xl sm:text-7xl md:text-8xl font-extrabold mb-8 leading-tight; /* Increased font size */
        }
        #main-page-overlay button {
            /* Changed to white background, text color matching overlay background */
            @apply bg-white hover:bg-gray-100 text-[#1e3a8a] text-2xl font-bold py-4 px-10 rounded-full shadow-xl transition-all duration-300 transform hover:scale-105 mt-8 border-2 border-[#1e3a8a];
        }
        /* Main page "Let's go!" button border */
        #main-page-overlay #start-exploration-button {
            border: 2px solid white; /* White border */
        }
        /* Removed Main page image styling */
        /* Removed Main page graphic element styling */
        /* New content box styling */
        #main-page-overlay .content-box {
            @apply bg-blue-800 p-6 rounded-lg shadow-xl max-w-3xl mx-auto text-white text-center; /* Changed text-left to text-center */
        }
        #main-page-overlay .content-box h3 { /* This was for "DIY ì•„ë‚ ë¡œê·¸ ì‹ ë””ì‚¬ì´ì € í”„ë¡œì íŠ¸" - can be removed or repurposed */
            @apply text-2xl sm:text-3xl font-bold mb-4 text-center;
        }
        #main-page-overlay .content-box ul { /* This was for the bullet list - will be replaced by spans */
            @apply space-y-3 text-lg;
        }
        #main-page-overlay .content-box li { /* This was for list items - will be replaced by spans */
            @apply flex items-start;
        }
        #main-page-overlay .content-box li span:first-child { /* This was for icon styling - can be removed or repurposed */
            @apply text-amber-300 mr-3 text-xl sm:text-2xl;
        }
        /* ìŠ¬ë¼ì´ë“œ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        .slide-container {
            position: relative;
            width: 100%;
            height: 500px; /* ìŠ¬ë¼ì´ë“œ ë†’ì´ ê³ ì • */
            overflow: hidden;
            margin-top: 2rem;
            border-radius: 0.5rem;
            background-color: #f0f0f0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            /* flexboxë¥¼ ì‚¬ìš©í•˜ì—¬ iframeì„ ì¤‘ì•™ì— ì •ë ¬í•˜ê³ , í•„ìš”í•œ ê²½ìš°ë§Œ ìŠ¤í¬ë¡¤ë°” í‘œì‹œ */
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: auto; /* ë‚´ìš©ì´ ë„˜ì¹  ê²½ìš° ìŠ¤í¬ë¡¤ í—ˆìš© */
        }

        /* ê° ìŠ¬ë¼ì´ë“œ í˜ì´ì§€ ìŠ¤íƒ€ì¼ - ì´ì œ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ */
        /*
        .slide-page {
            min-width: 100%;
            transition: transform 0.5s ease-in-out;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
            box-sizing: border-box;
            font-size: 1.1rem;
            color: #333;
            background-color: #fff;
        }
        .slide-page img {
            max-width: 90%;
            max-height: 80%;
            object-fit: contain;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 1rem;
        }
        */

        /* ìŠ¬ë¼ì´ë“œ ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ë° ì¸ë””ì¼€ì´í„°ëŠ” ì´ì œ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ */
        /*
        .slide-nav-button {
            @apply absolute top-1/2 -translate-y-1/2 px-4 py-2 bg-sky-600 text-white rounded-full shadow-lg hover:bg-sky-700 transition-colors z-10;
        }
        .slide-nav-button.left {
            left: 1rem;
        }
        .slide-nav-button.right {
            right: 1rem;
        }
        .slide-indicators {
            @apply flex justify-center mt-4 space-x-2;
        }
        .slide-indicator-dot {
            @apply w-3 h-3 bg-gray-300 rounded-full cursor-pointer;
        }
        .slide-indicator-dot.active {
            @apply bg-sky-600;
        }
        */
    </style>
</head>
<body class="flex flex-col min-h-screen bg-amber-50 text-stone-800 overflow-x-hidden">
    <div id="main-page-overlay">
        <h2 class="text-amber-300">Welcome to</h2>
        <h1 class="text-white">DIY Analog Synthesizer</h1>

        <div class="w-full max-w-md my-8 border-t-2 border-dashed border-white"></div>

        <div class="content-box">
            <div class="flex flex-wrap justify-center gap-2 mb-4">
                <span class="bg-blue-600 text-white px-3 py-1 rounded-full text-sm sm:text-base">#ì•„ë‚ ë¡œê·¸ì „ìë¶€í’ˆ</span>
                <span class="bg-blue-600 text-white px-3 py-1 rounded-full text-sm sm:text-base">#ì†Œë¦¬í•©ì„±ë³€í˜•</span>
                <span class="bg-blue-600 text-white px-3 py-1 rounded-full text-sm sm:text-base">#ë”°ëœ»í•˜ê³ í’ë¶€í•œìŒìƒ‰</span>
                <span class="bg-blue-600 text-white px-3 py-1 rounded-full text-sm sm:text-base">#ì•…ê¸°</span>
            </div>
            <p class="text-xl sm:text-2xl font-semibold text-center text-white mb-6">ì¬ë¯¸ìˆê²Œ íƒí—˜í•´ ë³¼ê¹Œìš”?</p>
        </div>

        <button id="start-exploration-button">
            Let's go !
        </button>
    </div>

    <header class="flex-shrink-0 bg-sky-700 text-white p-6 shadow-md sticky top-0 z-50 transition-transform duration-300 ease-in-out">
        <div class="container mx-auto flex flex-col sm:flex-row justify-between items-center">
            <div class="flex justify-between items-center w-full sm:w-auto">
                <h1 class="text-xl sm:text-2xl md:text-3xl font-bold text-white text-center sm:text-left mb-0 sm:mb-0">DIY ì•„ë‚ ë¡œê·¸ ì‹ ë””ì‚¬ì´ì € íƒí—˜</h1>
                <button id="mobile-menu-toggle" class="sm:hidden text-white text-2xl focus:outline-none ml-4">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            
            <nav class="hidden sm:flex mt-4 sm:mt-0 space-x-4">
                <button class="tab-button active" onclick="showSection('sound')">1. ì†Œë¦¬ì˜ ì„¸ê³„</button>
                <button class="tab-button" onclick="showSection('heart')">2. ì‹ ë””ì‚¬ì´ì €ì˜ ê¸°ë³¸ êµ¬ì¡°</button>
                <button class="tab-button" onclick="showSection('hands')">3. ì‹ ë””ì‚¬ì´ì € ì¡°ì‘ ë° ìŒìƒ‰ ì¡°ì ˆ</button>
                <button class="tab-button" onclick="showSection('play')">4. ì‹ ë””ì‚¬ì´ì € ì—°ì£¼ ì²´í—˜</button>
                <button class="tab-button" onclick="showSection('summary')">5. í•µì‹¬ ì •ë¦¬ì™€ ë‹¤ìŒ ë‹¨ê³„</button>
            </nav>
        </div>
    </header>

    <div id="mobile-nav-overlay" class="mobile-nav-overlay">
        <button id="close-mobile-menu" class="close-btn">
            <i class="fas fa-times"></i>
        </button>
        <div class="nav-links">
            <button class="tab-button" onclick="showSection('sound')">1. ì†Œë¦¬ì˜ ì„¸ê³„</button>
            <button class="tab-button" onclick="showSection('heart')">2. ì‹ ë””ì‚¬ì´ì €ì˜ ê¸°ë³¸ êµ¬ì¡°</l>
            <button class="tab-button" onclick="showSection('hands')">3. ì‹ ë””ì‚¬ì´ì € ì¡°ì‘ ë° ìŒìƒ‰ ì¡°ì ˆ</button>
            <button class="tab-button" onclick="showSection('play')">4. ì‹ ë””ì‚¬ì´ì € ì—°ì£¼ ì²´í—˜</button>
            <button class="tab-button" onclick="showSection('summary')">5. í•µì‹¬ ì •ë¦¬ì™€ ë‹¤ìŒ ë‹¨ê³„</button>
        </div>
    </div>

    <main class="flex-grow container mx-auto px-4 sm:px-8 lg:px-16 max-w-7xl flex flex-col overflow-hidden">
        <div id="sound" class="content-section">
            <h2 class="text-2xl font-bold text-sky-700 mb-4">1. ì†Œë¦¬ì˜ ì„¸ê³„ ğŸŒ</h2>
            <p class="mb-4">ì´ ì„¹ì…˜ì—ì„œëŠ” ìš°ë¦¬ ì£¼ë³€ì˜ 'ì†Œë¦¬'ê°€ ë¬´ì—‡ì¸ì§€, ì–´ë–»ê²Œ ë§Œë“¤ì–´ì§€ê³  ìš°ë¦¬ê°€ ì–´ë–»ê²Œ ë“£ê²Œ ë˜ëŠ”ì§€ ê¸°ë³¸ì ì¸ ì›ë¦¬ë¥¼ íƒí—˜í•©ë‹ˆë‹¤. ì‹ ë””ì‚¬ì´ì €ë¥¼ ì´í•´í•˜ê¸° ìœ„í•œ ì²«ê±¸ìŒ, ì‹œì‘í•´ë³¼ê¹Œìš”?</p>
            
            <div class="grid md:grid-cols-2 gap-6">
                <div class="component-card">
                    <h3 class="text-xl font-semibold text-emerald-700 mb-2">ì†Œë¦¬ì˜ ë°œìƒ ì›ë¦¬</h3>
                    <p>ì†Œë¦¬ëŠ” ë¬¼ì²´ê°€ <strong class="text-amber-600">ì§„ë™</strong>í•´ì„œ ë§Œë“¤ì–´ì§€ëŠ” ì—ë„ˆì§€ì˜ í•œ í˜•íƒœì˜ˆìš”. ê¸°íƒ€ ì¤„ì„ íŠ•ê¸°ë©´ ì¤„ì´ ë–¨ë¦¬ì£ ? ì´ ë–¨ë¦¼(ì§„ë™)ì´ ê³µê¸°ë¥¼ í”ë“¤ì–´ ìš°ë¦¬ ê·€ì— ë‹¿ìœ¼ë©´ ì†Œë¦¬ë¡œ ì¸ì‹ëœë‹µë‹ˆë‹¤. ë§ˆì¹˜ ë¬¼ ìœ„ì— ëŒì„ ë˜ì¡Œì„ ë•Œ ë¬¼ê²°ì´ í¼ì ¸ë‚˜ê°€ëŠ” ê²ƒê³¼ ë¹„ìŠ·í•´ìš”!</p>
                </div>
                <div class="component-card">
                    <h3 class="text-xl font-semibold text-emerald-700 mb-2">ì†Œë¦¬ì˜ ë†’ë‚®ì´ (ìŒê³ )</h3>
                    <p>ì†Œë¦¬ì˜ ë†’ë‚®ì´ëŠ” ì§„ë™ì´ ì–¼ë§ˆë‚˜ <strong class="text-amber-600">ë¹ ë¥´ê²Œ</strong> ì¼ì–´ë‚˜ëŠ”ì§€ì— ë”°ë¼ ê²°ì •ë¼ìš”. ì§„ë™ì´ ë¹ ë¥´ë©´ ë†’ì€ ì†Œë¦¬(ê³ ìŒ), ëŠë¦¬ë©´ ë‚®ì€ ì†Œë¦¬(ì €ìŒ)ê°€ ë‚˜ì£ . 1ì´ˆì— ëª‡ ë²ˆ ì§„ë™í•˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë‹¨ìœ„ë¥¼ <strong class="text-amber-600">ì£¼íŒŒìˆ˜(Hz)</strong>ë¼ê³  í•´ìš”. ì£¼íŒŒìˆ˜ê°€ ë†’ì„ìˆ˜ë¡ ë†’ì€ ì†Œë¦¬ê°€ ë‚©ë‹ˆë‹¤!</p>
                </div>
            </div>

<div class="interactive-box mt-6">
    <h4 class="text-lg font-semibold mb-2">ì£¼íŒŒìˆ˜ ì¡°ì ˆ ì²´í—˜</h4>
    
    <div class="flex flex-col md:flex-row items-center justify-center gap-4">
        <div class="chart-container mt-4 md:mt-0 w-full md:w-1/2">
            <canvas id="waveCanvas"></canvas>
        </div>
        
        <div class="w-full md:w-1/2 flex flex-col items-center">
            <p class="mb-2 text-sm text-center">ì•„ë˜ ìŠ¬ë¼ì´ë”ë¥¼ ì›€ì§ì—¬ ì£¼íŒŒìˆ˜ë¥¼ ì¡°ì ˆí•´ë³´ì„¸ìš”.<br> ì£¼íŒŒìˆ˜ì— ë”°ë¼ íŒŒí˜•ì´ ì–´ë–»ê²Œ ë³€í•˜ê³  ì†Œë¦¬ê°€ ì–´ë–»ê²Œ ë‹¬ë¼ì§€ëŠ”ì§€ ê´€ì°°í•´ë´…ì‹œë‹¤!</p>
            <input type="range" id="frequencySlider" min="1" max="20" value="5" class="w-full max-w-md mx-auto accent-amber-500">
            <p class="mt-2">í˜„ì¬ ì£¼íŒŒìˆ˜ ë‹¨ê³„: <span id="frequencyValue" class="font-bold text-sky-600">5</span></p>
            <p id="pitchDescription" class="mt-2 font-semibold h-6"></p> </div>
    </div>
</div>
        </div>

        <div id="heart" class="content-section hidden">
            <h2 class="text-2xl font-bold text-sky-700 mb-4">2. ì‹ ë””ì‚¬ì´ì €ì˜ ê¸°ë³¸ êµ¬ì¡°</h2>
            <p class="mb-4">ì•„ë‚ ë¡œê·¸ ì‹ ë””ì‚¬ì´ì €ëŠ” í¬ê²Œ <strong class="text-amber-600">ë°œì§„ê¸°(ì˜¤ì‹¤ë ˆì´í„°)</strong>, <strong class="text-amber-600">í•„í„°</strong>, <strong class="text-amber-600">ì•°í”„</strong> ë“±ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆì–´ìš”. ê·¸ ì¤‘ì—ì„œë„ ì˜¤ì‹¤ë ˆì´í„°ëŠ” ë‹¤ì–‘í•œ íŒŒí˜•ì˜ ì „ê¸° ì‹ í˜¸ë¥¼ ë§Œë“¤ì–´ë‚´ëŠ” í•µì‹¬ ë¶€í’ˆì…ë‹ˆë‹¤.</p>
            
            <div class="grid md:grid-cols-3 gap-6 mb-6">
                <div class="component-card">
                    <h3 class="text-xl font-semibold text-emerald-700 mb-2">ì˜¤ì‹¤ë ˆì´í„° (Oscillator)</h3>
                    <p>ì‚¬ê°íŒŒ, ì‚¼ê°íŒŒ, í†±ë‹ˆíŒŒ ë“± ë‹¤ì–‘í•œ íŒŒí˜•ì˜ ì „ê¸° ì‹ í˜¸ë¥¼ ë§Œë“¤ì–´ë‚´ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ì‹ ë””ì‚¬ì´ì € ì†Œë¦¬ì˜ <strong class="text-amber-600">ê¸°ë³¸ì ì¸ ìŒìƒ‰ê³¼ ë†’ë‚®ì´</strong>ë¥¼ ê²°ì •í•´ìš”.</p>
                </div>
                <div class="component-card">
                    <h3 class="text-xl font-semibold text-emerald-700 mb-2">í•„í„° (Filter)</h3>
                    <p>ë§Œë“¤ì–´ì§„ ì†Œë¦¬ì˜ íŠ¹ì • ì£¼íŒŒìˆ˜ ì˜ì—­ì„ <strong class="text-amber-600">ê°•ì¡°í•˜ê±°ë‚˜ ì•½í™”</strong>ì‹œì¼œ ìŒìƒ‰ì„ ë°”ê¿”ì£¼ëŠ” ì—­í• ì„ í•´ìš”. íƒí•œ ì†Œë¦¬ë¥¼ ë§‘ê²Œ í•˜ê±°ë‚˜, ë‚ ì¹´ë¡œìš´ ì†Œë¦¬ë¥¼ ë¶€ë“œëŸ½ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
                <div class="component-card">
                    <h3 class="text-xl font-semibold text-emerald-700 mb-2">ì•°í”„ (Amplifier)</h3>
                    <p>ì˜¤ì‹¤ë ˆì´í„°ì™€ í•„í„°ë¥¼ ê±°ì³ ë§Œë“¤ì–´ì§„ ì†Œë¦¬ ì‹ í˜¸ëŠ” ë§¤ìš° ì‘ì•„ìš”. ì•°í”„ëŠ” ì´ ì‹ í˜¸ì˜ <strong class="text-amber-600">í¬ê¸°ë¥¼ ì¡°ì ˆ</strong>í•˜ì—¬ ìš°ë¦¬ê°€ ë“¤ì„ ìˆ˜ ìˆëŠ” ì¶©ë¶„í•œ ë³¼ë¥¨ìœ¼ë¡œ í‚¤ì›Œì¤ë‹ˆë‹¤.</p>
                </div>
            </div>

            <h3 class="text-xl font-bold text-sky-700 mb-4">ìš°ë¦¬ê°€ ë§Œë“¤ ì‹ ë””ì‚¬ì´ì €ì— ì‚¬ìš©ë˜ëŠ” ë¶€í’ˆë“¤</h3>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="col-span-1">
                    <h4 class="text-lg font-semibold text-emerald-600 mb-2">ë°œì§„ê¸°(ì˜¤ì‹¤ë ˆì´í„°) ê´€ë ¨ ë¶€í’ˆ</h4>
                    <div class="space-y-4"> <div class="component-card">
                            <h3 class="text-xl font-semibold text-emerald-700 mb-2">555 íƒ€ì´ë¨¸: ë°œì§„ê¸° í•µì‹¬ ë¶€í’ˆ</h3>
                            <p>ìš°ë¦¬ê°€ ë§Œë“¤ ì‹ ë””ì‚¬ì´ì €ì˜ <strong class="text-amber-600">ì˜¤ì‹¤ë ˆì´í„°</strong>ëŠ” ë°”ë¡œ ì´ 555 íƒ€ì´ë¨¸ë¥¼ í™œìš©í•˜ì—¬ êµ¬ì„±ë©ë‹ˆë‹¤. 555 íƒ€ì´ë¨¸ëŠ” ê·œì¹™ì ì¸ <strong class="text-amber-600">ì „ê¸° ì‹ í˜¸(í„ìŠ¤)</strong>ë¥¼ ë§Œë“¤ì–´ë‚´ë©°, ì´ í„ìŠ¤ì˜ ë¹ ë¥´ê¸°ê°€ ì†Œë¦¬ì˜ ë†’ë‚®ì´ë¥¼ ê²°ì •í•˜ëŠ” í•µì‹¬ì ì¸ ì—­í• ì„ í•©ë‹ˆë‹¤.</p>
                            <div class="heart-canvas-container mt-2">
                                <canvas id="timerAnimationCanvas"></canvas>
                            </div>
                        </div>
                        <div class="component-card">
                            <h3 class="text-xl font-semibold text-emerald-700 mb-2">ìŠˆë¯¸íŠ¸ íŠ¸ë¦¬ê±°: íŒŒí˜• ë‹¤ë“¬ê¸°</h3>
                            <p>555 íƒ€ì´ë¨¸ê°€ ìƒì„±í•œ ì‹ í˜¸ë¥¼ ë”ìš± ê¹¨ë—í•˜ê³  ì•ˆì •ì ì¸ <strong class="text-amber-600">ì‚¬ê°íŒŒ</strong> í˜•íƒœë¡œ ë‹¤ë“¬ì–´ì£¼ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ìŠˆë¯¸íŠ¸ íŠ¸ë¦¬ê±°ëŠ” íŠ¹ì • ì „ì••(ì„ê³„ê°’)ì„ ê¸°ì¤€ìœ¼ë¡œ ì¶œë ¥ì„ í™•ì‹¤í•˜ê²Œ ì „í™˜ì‹œì¼œ, ëª…í™•í•œ íŒŒí˜•ì„ ë§Œë“¤ì–´ <strong class="text-amber-600">ì˜¤ì‹¤ë ˆì´í„°</strong>ì˜ ì¤‘ìš”í•œ ë¶€ë¶„ì´ ë©ë‹ˆë‹¤.</p>
                            <div class="heart-canvas-container mt-2">
                                <canvas id="schmittTriggerAnimationCanvas"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-span-1">
                    <h4 class="text-lg font-semibold text-emerald-600 mb-2">ì•°í”„ ê´€ë ¨ ë¶€í’ˆ</h4>
                    <div class="space-y-4">
                        <div class="component-card">
                            <h3 class="text-xl font-semibold text-emerald-700 mb-2">OP-AMP (ì—°ì‚° ì¦í­ê¸°): ì•°í”„ ì—­í• </h3>
                            <p>555 íƒ€ì´ë¨¸ì™€ ìŠˆë¯¸íŠ¸ íŠ¸ë¦¬ê±°ë¥¼ í†µí•´ ë§Œë“¤ì–´ì§„ ì†Œë¦¬ ì‹ í˜¸ëŠ” ì•„ì§ ë§¤ìš° ì‘ìŠµë‹ˆë‹¤. <strong class="text-amber-600">ì•°í”„</strong> ì—­í• ì„ í•˜ëŠ” OP-AMPëŠ” ì´ ì‘ì€ ì‹ í˜¸ë¥¼ í¬ê²Œ <strong class="text-amber-600">ì¦í­</strong>ì‹œì¼œ ìš°ë¦¬ê°€ ìŠ¤í”¼ì»¤ë¥¼ í†µí•´ ë“¤ì„ ìˆ˜ ìˆë„ë¡ í•´ì¤ë‹ˆë‹¤.</p>
                            <div id="opampAnimation" class="mt-2 h-16 bg-emerald-100 rounded flex items-center justify-center text-sm text-emerald-700">
                                ì‹ í˜¸ ì¦í­ ì¤‘... (ì†Œë¦¬ê°€ ì»¤ì§‘ë‹ˆë‹¤!)
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="hands" class="content-section hidden">
            <h2 class="text-2xl font-bold text-sky-700 mb-4">3. ì‹ ë””ì‚¬ì´ì € ì¡°ì‘ ë° ìŒìƒ‰ ì¡°ì ˆ: ì£¼ìš” ë¶€í’ˆë“¤ ğŸ–ï¸ğŸ¦¶</h2>
            <p class="mb-4">ì‹ ë””ì‚¬ì´ì €ë¥¼ ì§ì ‘ ì¡°ì‘í•˜ê³  ì†Œë¦¬ë¥¼ ë‹¤ì–‘í•˜ê²Œ ë§Œë“¤ê¸° ìœ„í•´ ì „ê¸° íë¦„ì„ ì¡°ì ˆí•˜ëŠ” 'ì €í•­', ì†Œë¦¬ ë†’ë‚®ì´ë¥¼ ë°”ê¾¸ëŠ” 'ê°€ë³€ì €í•­', ì†Œë¦¬ë¥¼ ì¼œê³  ë„ëŠ” 'íƒíŠ¸ ìŠ¤ìœ„ì¹˜'ì— ëŒ€í•´ ì•Œì•„ë³¼ê¹Œìš”?</p>
            <div class="grid md:grid-cols-3 gap-6">
                <div class="component-card">
                    <h3 class="text-xl font-semibold text-emerald-700 mb-2">ì €í•­: ì „ê¸° íë¦„ì˜ ë¬¸ì§€ê¸°</h3>
                    <p>ì €í•­ì€ ì „ê¸° íšŒë¡œì—ì„œ ì „ë¥˜ì˜ ì–‘ì„ ì¡°ì ˆí•˜ê±°ë‚˜ ì „ì••ì„ ë‚˜ëˆ„ëŠ” ì—­í• ì„ í•´ìš”. ë§ˆì¹˜ ìˆ˜ë„ê¼­ì§€ë¡œ ë¬¼ì˜ ì–‘ì„ ì¡°ì ˆí•˜ë“¯, ì €í•­ì€ ì „ê¸° ì—ë„ˆì§€ì˜ íë¦„ì„ <strong class="text-amber-600">ì ì ˆí•˜ê²Œ ì œì–´</strong>í•©ë‹ˆë‹¤. 555 íƒ€ì´ë¨¸ì˜ ì‘ë™ ì†ë„ ì¡°ì ˆì—ë„ ê´€ì—¬í•´ìš”.</p>
                </div>
                <div class="component-card">
                    <h3 class="text-xl font-semibold text-emerald-700 mb-2">ê°€ë³€ì €í•­: ì†Œë¦¬ ë†’ë‚®ì´ ë§ˆë²•ì‚¬</h3>
                    <p>ê°€ë³€ì €í•­ì€ ì†ì¡ì´ë¥¼ ëŒë¦¬ê±°ë‚˜ ìŠ¬ë¼ì´ë“œë¥¼ ì›€ì§ì—¬ ì €í•­ê°’ì„ ë°”ê¿€ ìˆ˜ ìˆëŠ” íŠ¹ë³„í•œ ì €í•­ì´ì—ìš”. ì‹ ë””ì‚¬ì´ì €ì—ì„œëŠ” ì´ ê°€ë³€ì €í•­ì„ ì´ìš©í•˜ì—¬ 555 íƒ€ì´ë¨¸ì— ì—°ê²°ëœ ì €í•­ê°’ì„ ë³€í™”ì‹œí‚¤ê³ , ê²°ê³¼ì ìœ¼ë¡œ <strong class="text-amber-600">ì†Œë¦¬ì˜ ë†’ë‚®ì´ë¥¼ ë§ˆìŒëŒ€ë¡œ ì¡°ì ˆ</strong>í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤. ë¼ë””ì˜¤ ë³¼ë¥¨ ì¡°ì ˆê¸°ì²˜ëŸ¼ìš”!</p>
                     <div class="interactive-box mt-2">
                        <label for="potentiometerDemo" class="block text-sm font-medium text-gray-700">ê°€ë³€ì €í•­ ì²´í—˜: <span id="potentiometerValue" class="font-bold text-sky-600">50</span>%</label>
                        <input type="range" id="potentiometerDemo" min="0" max="100" value="50" class="w-full accent-amber-500 mt-1">
                    </div>
                    <p class="mt-2">ë˜í•œ, ì‚¬ê°íŒŒì˜ <strong class="text-amber-600">í„ìŠ¤ í­(Duty Cycle)</strong>ì€ íŒŒí˜•ì´ 'ì¼œì ¸ ìˆëŠ”' ì‹œê°„ì˜ ë¹„ìœ¨ì„ ì˜ë¯¸í•˜ë©°, ì´ëŠ” ì†Œë¦¬ì˜ <strong class="text-amber-600">ìŒìƒ‰(Timbre)</strong>ì„ ë³€í™”ì‹œí‚µë‹ˆë‹¤. 555 íƒ€ì´ë¨¸ì™€ ê°™ì€ ë°œì§„ íšŒë¡œì—ì„œëŠ” ì €í•­ê°’ì„ ì¡°ì ˆí•˜ì—¬ ì´ í„ìŠ¤ í­ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                     <div class="interactive-box mt-4">
                        <label for="handsPulseWidthKnob" class="block text-sm font-medium text-gray-700">
                            í„ìŠ¤ í­ ì¡°ì ˆ (Duty Cycle): <span id="handsPulseWidthValue" class="font-bold text-sky-600">50</span>%
                        </label>
                        <input type="range" id="handsPulseWidthKnob" min="10" max="90" value="50" class="w-full accent-purple-500 mt-1">
                        <canvas id="handsPulseWidthCanvas" class="mt-2 w-full h-16 rounded bg-amber-100"></canvas>
                    </div>
                </div>
                <div class="component-card">
                    <h3 class="text-xl font-semibold text-emerald-700 mb-2">íƒíŠ¸ ìŠ¤ìœ„ì¹˜: ì†Œë¦¬ ì¬ìƒ ë²„íŠ¼</h3>
                    <p>íƒíŠ¸ ìŠ¤ìœ„ì¹˜ëŠ” ëˆ„ë¥´ë©´ íšŒë¡œê°€ ì—°ê²°ë˜ì–´ ì†Œë¦¬ê°€ ë‚˜ê³ , ì†ì„ ë–¼ë©´ íšŒë¡œê°€ ë©ˆì¶”ëŠ” <strong class="text-amber-600">ë²„íŠ¼</strong>ì´ì—ìš”. ì „ë“± ìŠ¤ìœ„ì¹˜ì²˜ëŸ¼ ì „ê¸°ì˜ ê¸¸ì„ ì—´ì—ˆë‹¤ ë‹«ì•˜ë‹¤ í•˜ë©° ì‹ ë””ì‚¬ì´ì € ì†Œë¦¬ë¥¼ ì œì–´í•©ë‹ˆë‹¤.</p>
                    <div class="interactive-box mt-2">
                        <button id="tactSwitchDemo" class="bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded transition-colors">
                            ìŠ¤ìœ„ì¹˜ ëˆ„ë¥´ê¸°!
                        </button>
                        <p id="tactSwitchStatus" class="text-sm mt-1">ìŠ¤ìœ„ì¹˜ ìƒíƒœ: êº¼ì§ (ë§ˆìš°ìŠ¤ í´ë¦­ ë˜ëŠ” ìŠ¤í˜ì´ìŠ¤ë°” í‚¤ë¡œ ì¡°ì‘)</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="play" class="content-section hidden">
            <h2 class="text-2xl font-bold text-sky-700 mb-4">4. ì‹ ë””ì‚¬ì´ì € ì—°ì£¼ ì²´í—˜: ì†Œë¦¬ë¥¼ ì§ì ‘ ë§Œë“¤ì–´ë³´ì! ğŸ¹âœ¨</h2>
            <p class="mb-4">ì§€ê¸ˆê¹Œì§€ ë°°ìš´ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ì‹ ë””ì‚¬ì´ì €ë¥¼ ì—°ì£¼í•´ë´…ì‹œë‹¤! ê°€ë³€ì €í•­ìœ¼ë¡œ ìŒë†’ì´ë¥¼ ì¡°ì ˆí•˜ê³ , íƒíŠ¸ ìŠ¤ìœ„ì¹˜ë¡œ ì†Œë¦¬ë¥¼ ë‚´ë³´ì„¸ìš”.</p>
            
            <div class="bg-stone-200 p-4 rounded-lg shadow-inner max-w-2xl mx-auto flex flex-col flex-grow select-none">
                <h3 class="text-xl font-semibold text-center text-stone-700 mb-4">ì•„ë‚ ë¡œê·¸ ì‹ ë””ì‚¬ì´ì € ì‹œë®¬ë ˆì´í„°</h3>
                
                <div class="flex flex-col items-center space-y-4 flex-grow">
                    <div class="grid grid-cols-2 gap-4 mb-4 w-full justify-items-start sm:flex sm:flex-wrap sm:justify-center">
                        <label class="inline-flex items-center justify-start sm:justify-center">
                            <input type="radio" name="waveformType" value="sine" class="form-radio text-sky-600 accent-sky-600" checked>
                            <span class="ml-2 text-sm font-medium text-gray-700">ì‚¬ì¸íŒŒ (Sine)</span>
                        </label>
                        <label class="inline-flex items-center justify-start sm:justify-center">
                            <input type="radio" name="waveformType" value="square" class="form-radio text-sky-600 accent-sky-600">
                            <span class="ml-2 text-sm font-medium text-gray-700">ì‚¬ê°íŒŒ (Square)</span>
                        </label>
                        <label class="inline-flex items-center justify-start sm:justify-center">
                            <input type="radio" name="waveformType" value="sawtooth" class="form-radio text-sky-600 accent-sky-600">
                            <span class="ml-2 text-sm font-medium text-gray-700">í†±ë‹ˆíŒŒ (Sawtooth)</span>
                        </label>
                        <label class="inline-flex items-center justify-start sm:justify-center">
                            <input type="radio" name="waveformType" value="triangle" class="form-radio text-sky-600 accent-sky-600">
                            <span class="ml-2 text-sm font-medium text-gray-700">ì‚¼ê°íŒŒ (Triangle)</span>
                        </label>
                    </div>

                    <div class="flex flex-col md:flex-row items-center justify-center gap-4 w-full">
                        <div class="chart-container w-full md:w-1/2 h-48"> <canvas id="synthOutputCanvas"></canvas>
                        </div>
                        
                        <div class="w-full md:w-1/2 flex flex-col items-center space-y-4">
                            <div id="pulseWidthControl" class="w-full max-w-xs"> <label for="pulseWidthKnob" class="block text-sm font-medium text-gray-700 mb-1">í„ìŠ¤ í­ ì¡°ì ˆ (ë“€í‹° ì‚¬ì´í´): <span id="pulseWidthValue" class="font-bold">50</span>%</label>
                                <input type="range" id="pulseWidthKnob" min="10" max="90" value="50" class="w-full accent-purple-500">
                            </div>

                            <div class="w-full max-w-xs"> <label for="synthPitchKnob" class="block text-sm font-medium text-gray-700 mb-1">ìŒë†’ì´ ì¡°ì ˆ (ê°€ë³€ì €í•­): <span id="synthPitchValue" class="font-bold">50</span></label>
                                <input type="range" id="synthPitchKnob" min="1" max="100" value="50" class="w-full accent-amber-500">
                            </div>
                        </div>
                    </div>
                    
                    <p id="synthOutputStatus" class="mt-2 text-center font-semibold text-stone-700 h-6"></p>

                    <div class="flex flex-col gap-4 w-full items-center">
                        <div class="flex flex-wrap justify-center gap-4 sm:gap-6 md:gap-8">
                            <button class="synth-button rounded-lg shadow transition-transform hover:scale-105" data-note-full="C5">ë„</button>
                            <button class="synth-button rounded-lg shadow transition-transform hover:scale-105" data-note-full="D5">ë ˆ</button>
                            <button class="synth-button rounded-lg shadow transition-transform hover:scale-105" data-note-full="E5">ë¯¸</button>
                            <button class="synth-button rounded-lg shadow transition-transform hover:scale-105" data-note-full="F5">íŒŒ</button>
                            <button class="synth-button rounded-lg shadow transition-transform hover:scale-105" data-note-full="G5">ì†”</button>
                            <button class="synth-button rounded-lg shadow transition-transform hover:scale-105" data-note-full="A5">ë¼</button>
                            <button class="synth-button rounded-lg shadow transition-transform hover:scale-105" data-note-full="B5">ì‹œ</button>
                        </div>
                        <div class="flex flex-wrap justify-center gap-4 sm:gap-6 md:gap-8">
                            <button class="synth-button rounded-lg shadow transition-transform hover:scale-105" data-note-full="C4">ë„</button>
                            <button class="synth-button rounded-lg shadow transition-transform hover:scale-105" data-note-full="D4">ë ˆ</button>
                            <button class="synth-button rounded-lg shadow transition-transform hover:scale-105" data-note-full="E4">ë¯¸</button>
                            <button class="synth-button rounded-lg shadow transition-transform hover:scale-105" data-note-full="F4">íŒŒ</button>
                            <button class="synth-button rounded-lg shadow transition-transform hover:scale-105" data-note-full="G4">ì†”</button>
                            <button class="synth-button rounded-lg shadow transition-transform hover:scale-105" data-note-full="A4">ë¼</button>
                            <button class="synth-button rounded-lg shadow transition-transform hover:scale-105" data-note-full="B4">ì‹œ</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="summary" class="content-section hidden">
            <h2 class="text-2xl font-bold text-sky-700 mb-4">5. í•µì‹¬ ì •ë¦¬ì™€ ë‹¤ìŒ ë‹¨ê³„ ğŸ’¡</h2>
            <p class="mb-4">ì˜¤ëŠ˜ ìš°ë¦¬ëŠ” ì†Œë¦¬ì˜ ì‹ ë¹„ë¡œìš´ ì„¸ê³„ë¶€í„° ì‹ ë””ì‚¬ì´ì €ì˜ ì‘ë™ ì›ë¦¬ê¹Œì§€ ë§ì€ ê²ƒì„ ë°°ì› ì–´ìš”. ì´ ì„¹ì…˜ì—ì„œëŠ” ì£¼ìš” ë‚´ìš©ì„ ë‹¤ì‹œ í•œë²ˆ ì •ë¦¬í•˜ê³ , ì•ìœ¼ë¡œ ë” ì¬ë¯¸ìˆê²Œ ì „ìê³µí•™ì„ íƒêµ¬í•  ìˆ˜ ìˆëŠ” ëª‡ ê°€ì§€ íŒì„ ì•Œë ¤ì¤„ê²Œìš”!</p>
            
            <div class="space-y-4">
                <div class="component-card">
                    <h3 class="text-xl font-semibold text-emerald-700 mb-2">ì˜¤ëŠ˜ ë°°ìš´ í•µì‹¬ ë‚´ìš©:</h3>
                    <ul class="list-disc list-inside space-y-1 text-sm">
                        <li>ì†Œë¦¬ëŠ” ë¬¼ì²´ì˜ <strong class="text-amber-600">ì§„ë™</strong>ìœ¼ë¡œ ë°œìƒí•˜ë©°, ì§„ë™ ì†ë„(ì£¼íŒŒìˆ˜)ì— ë”°ë¼ ë†’ë‚®ì´ê°€ ê²°ì •ë¼ìš”.</li>
                        <li><strong class="text-amber-600">555 íƒ€ì´ë¨¸</strong>ëŠ” ê·œì¹™ì ì¸ ì‹ í˜¸ë¥¼ ë§Œë“¤ì–´ ì†Œë¦¬ì˜ ê¸°ë³¸ ì£¼íŒŒìˆ˜ë¥¼ ìƒì„±í•´ìš”.</li>
                        <li><strong class="text-amber-600">ìŠˆë¯¸íŠ¸ íŠ¸ë¦¬ê±°</strong>ëŠ” ë¶ˆì•ˆì •í•œ ì‹ í˜¸ë¥¼ ê¹¨ë—í•œ ì‚¬ê°íŒŒ í„ìŠ¤ë¡œ ë³€í™˜í•˜ì—¬ ì†Œë¦¬ë¥¼ ëª…í™•í•˜ê²Œ ë§Œë“¤ì–´ì¤˜ìš”.</li>
                        <li><strong class="text-amber-600">OP-AMP</strong>ëŠ” ì‘ì€ ì†Œë¦¬ ì‹ í˜¸ë¥¼ í¬ê²Œ ì¦í­ì‹œì¼œ ìš°ë¦¬ê°€ ë“¤ì„ ìˆ˜ ìˆê²Œ í•´ìš”.</li>
                        <li><strong class="text-amber-600">ì €í•­</strong>ì€ ì „ë¥˜ë¥¼ ì œì–´í•˜ê³ , <strong class="text-amber-600">ê°€ë³€ì €í•­</strong>ìœ¼ë¡œ ìŒë†’ì´ë¥¼ ì¡°ì ˆí•˜ë©°, <strong class="text-amber-600">íƒíŠ¸ ìŠ¤ìœ„ì¹˜</strong>ë¡œ ì†Œë¦¬ë¥¼ ì¼œê³  ëŒ ìˆ˜ ìˆì–´ìš”.</li>
                        <li>ì´ ëª¨ë“  ë¶€í’ˆë“¤ì´ ëª¨ì—¬ ì‹ ë””ì‚¬ì´ì €ë¼ëŠ” ì•…ê¸°ê°€ ëœë‹µë‹ˆë‹¤!</li>
                    </ul>
                </div>
                 <div class="component-card">
                    <h3 class="text-xl font-semibold text-emerald-700 mb-2">í•™ìŠµ ì§„í–‰ íŒ (from êµìœ¡ê³¼ì •):</h3>
                    <ul class="list-disc list-inside space-y-1 text-sm">
                        <li><strong>ì‹œê° ìë£Œ í™œìš©:</strong> ê·¸ë¦¼ì´ë‚˜ ì• ë‹ˆë©”ì´ì…˜ì„ ë³´ë©´ ì´í•´ê°€ ë” ì‰¬ì›Œìš”. (ì´ ì•±ì²˜ëŸ¼ìš”!)</li>
                        <li><strong>ë¹„ìœ ì™€ ì‹¤ìƒí™œ ì˜ˆì‹œ:</strong> ì–´ë ¤ìš´ ì›ë¦¬ë„ ì£¼ë³€ì˜ ë¬¼ê±´ì— ë¹„ìœ í•˜ë©´ ì¬ë¯¸ìˆê²Œ ë°°ìš¸ ìˆ˜ ìˆì–´ìš”.</li>
                        <li><strong>ì§ˆë¬¸ì€ ì–¸ì œë‚˜ í™˜ì˜:</strong> ê¶ê¸ˆí•œ ì ì´ ìˆë‹¤ë©´ ì£¼ì €í•˜ì§€ ë§ê³  ì§ˆë¬¸í•˜ì„¸ìš”!</li>
                        <li><strong>ì§ì ‘ ì²´í—˜í•˜ê¸°:</strong> ì§ì ‘ ë§Œì ¸ë³´ê³  ì¡°ì‘í•´ë³´ëŠ” ê²ƒì´ ìµœê³ ì˜ í•™ìŠµ ë°©ë²•ì´ì—ìš”.</li>
                        <li><strong>ì•ˆì „ ì œì¼:</strong> ì „ì ë¶€í’ˆì„ ë‹¤ë£° ë•ŒëŠ” í•­ìƒ ì•ˆì „ ìˆ˜ì¹™ì„ ì§€ì¼œì£¼ì„¸ìš”.</li>
                    </ul>
                </div>

                <!-- ìŠ¬ë¼ì´ë“œ ì„¹ì…˜ ì‹œì‘: Canva ìŠ¬ë¼ì´ë“œ ì„ë² ë“œ -->
                <div class="component-card">
                    <h3 class="text-xl font-semibold text-emerald-700 mb-4">ì „ìíšŒë¡œ êµ¬ì„± í•™ìŠµ ìŠ¬ë¼ì´ë“œ</h3>
                    <div class="slide-container">
                        <!-- Canva ìŠ¬ë¼ì´ë“œë¥¼ ì„ë² ë“œí•©ë‹ˆë‹¤. Canva embed íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. -->
                        <iframe src="https://www.canva.com/design/DAGqPNWGerM/PETWQ8fUuKBvXzF0B287xw/view?embed"
                                width="100%"
                                height="100%"
                                allowfullscreen
                                allow="fullscreen"
                                style="border: none; border-radius: 0.5rem; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);">
                        </iframe>
                    </div>
                    <p class="mt-4 text-center text-sm text-gray-600">
                        ìœ„ ìŠ¬ë¼ì´ë“œëŠ” Canvaì—ì„œ ì œê³µí•˜ëŠ” ì„ë² ë“œ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ í‘œì‹œë©ë‹ˆë‹¤.
                        ìŠ¬ë¼ì´ë“œ ë‚´ì—ì„œ ì œê³µë˜ëŠ” ì»¨íŠ¸ë¡¤ì„ ì‚¬ìš©í•˜ì—¬ íƒìƒ‰í•´ì£¼ì„¸ìš”.
                    </p>
                </div>
                <!-- ìŠ¬ë¼ì´ë“œ ì„¹ì…˜ ë -->

                <p class="mt-4 text-center font-semibold">ì—¬ëŸ¬ë¶„ì˜ ì°½ì˜ë ¥ê³¼ í˜¸ê¸°ì‹¬ìœ¼ë¡œ ë” ë©‹ì§„ ì†Œë¦¬ì™€ ì¥ì¹˜ë“¤ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”! ğŸš€</p>
            </div>
        </div>
    </main>

    <footer class="text-center p-4 text-sm text-sky-800 mt-8">
        COPYRIGHT â€ŒTECHTREESPACE Â© 2017-2025. ALL RIGHTS RESERVED.
    </footer>

    <script>
        const sections = ['sound', 'heart', 'hands', 'play', 'summary'];
        const tabButtons = document.querySelectorAll('.tab-button');
        const contentSections = document.querySelectorAll('.content-section');
        let currentActiveSectionId = 'sound'; // í˜„ì¬ í™œì„±í™”ëœ ì„¹ì…˜ IDë¥¼ ì¶”ì í•˜ëŠ” ë³€ìˆ˜

        // ì• ë‹ˆë©”ì´ì…˜ í”„ë ˆì„ IDë¥¼ ì €ì¥í•˜ì—¬ ì¤‘ì§€í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.
        window.timerAnimationId = null; 
        window.schmittAnimationId = null; 
        window.handsAnimationId = null; // Hands ì„¹ì…˜ ì• ë‹ˆë©”ì´ì…˜ ID ì¶”ê°€

        // Mobile Navigation Elements
        const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
        const mobileNavOverlay = document.getElementById('mobile-nav-overlay');
        const closeMobileMenu = document.getElementById('close-mobile-menu');
        const mobileNavLinks = document.querySelector('#mobile-nav-overlay .nav-links');

        function openMobileNav() {
            mobileNavOverlay.classList.add('open');
            document.body.style.overflow = 'hidden'; // Prevent scrolling background
        }

        function closeMobileNav() {
            mobileNavOverlay.classList.remove('open');
            document.body.style.overflow = ''; // Restore scrolling
        }

        // Event Listeners for Mobile Menu
        if (mobileMenuToggle) {
            mobileMenuToggle.addEventListener('click', openMobileNav);
        }
        if (closeMobileMenu) {
            closeMobileMenu.addEventListener('click', closeMobileNav); 
        }
        // Close mobile nav when a link is clicked
        if (mobileNavLinks) {
            mobileNavLinks.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', closeMobileNav); 
            });
        }


        function showSection(sectionId) {
            // ëª¨ë“  ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            contentSections.forEach(section => {
                section.classList.add('hidden');
            });
            // ì„ íƒëœ ì„¹ì…˜ ë³´ì´ê¸°
            document.getElementById(sectionId).classList.remove('hidden');

            // íƒ­ ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸ (ë°ìŠ¤í¬í†± ë©”ë‰´)
            document.querySelector('header nav').querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
                if (button.getAttribute('onclick').includes(sectionId)) {
                    button.classList.add('active');
                }
            });

            // íƒ­ ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸ (ëª¨ë°”ì¼ ì˜¤ë²„ë ˆì´ ë©”ë‰´)
            document.querySelector('#mobile-nav-overlay .nav-links').querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
                if (button.getAttribute('onclick').includes(sectionId)) {
                    button.classList.add('active');
                }
            });

            currentActiveSectionId = sectionId; // í˜„ì¬ í™œì„±í™”ëœ ì„¹ì…˜ ì—…ë°ì´íŠ¸
            window.scrollTo(0, 0); // ìŠ¤í¬ë¡¤ ë§¨ ìœ„ë¡œ

            // ì„¹ì…˜ì— ë”°ë¼ ìº”ë²„ìŠ¤ ì´ˆê¸°í™” ë˜ëŠ” ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘/ì¤‘ì§€
            if (sectionId === 'sound') {
                setupWaveCanvas();
                // 'sound' ì„¹ì…˜ ì§„ì… ì‹œ íŒŒí˜•ì„ ì‚¬ì¸íŒŒë¡œ ì„¤ì •í•˜ê³  ë¼ë””ì˜¤ ë²„íŠ¼ë„ ì—…ë°ì´íŠ¸
                selectedWaveformType = 'sine';
                const sineRadio = document.querySelector('input[name="waveformType"][value="sine"]');
                if (sineRadio) {
                    sineRadio.checked = true;
                }
                // ì‚¬ì¸íŒŒê°€ ì•„ë‹ˆë©´ í„ìŠ¤ í­ ì¡°ì ˆ ìŠ¬ë¼ì´ë”ë¥¼ ìˆ¨ê¸¸ í•„ìš”ëŠ” ì—†ìŒ (play ì„¹ì…˜ì—ì„œ ê´€ë¦¬)
                // ê·¸ëŸ¬ë‚˜ sound ì„¹ì…˜ì—ì„œëŠ” play ì„¹ì…˜ì˜ UIë¥¼ ê±´ë“œë¦¬ì§€ ì•ŠìŒ.
                stopHandsAnimations();
                stopHeartAnimations();

            } else if (sectionId === 'play') {
                setupSynthCanvas();
                // 'play' ì„¹ì…˜ìœ¼ë¡œ ì´ë™ ì‹œ, íŒŒí˜• íƒ€ì…ì„ UIì˜ ê¸°ë³¸ ì„ íƒ(sine)ìœ¼ë¡œ ë§ì¶¤
                const defaultWaveformRadio = document.querySelector('input[name="waveformType"][value="sine"]');
                if (defaultWaveformRadio) {
                    defaultWaveformRadio.checked = true; // UIì—ì„œ ì‚¬ì¸íŒŒë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì„ íƒ
                }
                selectedWaveformType = 'sine'; // ì‹¤ì œ ì˜¤ë””ì˜¤ íŒŒí˜• íƒ€ì…ë„ ì‚¬ì¸ìœ¼ë¡œ ì„¤ì •
                console.log("Entered 'play' section, selectedWaveformType set to 'sine'");

                // í˜„ì¬ ì„ íƒëœ íŒŒí˜•(ì´ì œ 'sine'ì´ì–´ì•¼ í•¨)ì— ë”°ë¼ í„ìŠ¤ í­ ì¡°ì ˆ UI í‘œì‹œ/ìˆ¨ê¹€
                const pulseWidthControlUI = document.getElementById('pulseWidthControl'); // ë³€ìˆ˜ëª… ëª…í™•í™”
                if (selectedWaveformType === 'square') { // ì´ ì¡°ê±´ì€ sineìœ¼ë¡œ ì„¤ì •í–ˆìœ¼ë¯€ë¡œ false
                    pulseWidthControlUI.classList.remove('hidden');
                } else {
                    pulseWidthControlUI.classList.add('hidden');
                }
                stopHandsAnimations(); 
                stopHeartAnimations(); 

            } else if (sectionId === 'hands') {
                setupHandsCanvases(); // Added to ensure hands canvas is set up when section is shown
                startHandsAnimations(); 
                stopHeartAnimations(); 

            } else if (sectionId === 'heart') {
                startHeartAnimations();
                stopHandsAnimations(); 

            } else if (sectionId === 'summary') { 
                // summary ì„¹ì…˜ ì§„ì… ì‹œ, ë” ì´ìƒ custom slide setupì„ í˜¸ì¶œí•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.
                // Canva iframeì´ ì´ë¯¸ HTMLì— ìˆìœ¼ë¯€ë¡œ ë‹¨ìˆœíˆ ì„¹ì…˜ì„ í‘œì‹œí•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.
                stopHandsAnimations();
                stopHeartAnimations();
            } else { // For other sections, stop all animations
                stopHandsAnimations();
                stopHeartAnimations();
            }
        }

        const startExplorationButton = document.getElementById('start-exploration-button');
        const mainPageOverlay = document.getElementById('main-page-overlay');

        if (startExplorationButton) {
            startExplorationButton.addEventListener('click', () => {
                mainPageOverlay.classList.add('hidden');
                // Ensure audio context is initialized when user interacts for the first time
                initAudio(); 
            });
        }

        let audioContext = null; // Initialize to null
        let oscillator = null; // Changed to null for persistent management
        let gainNode = null; // Changed to null for persistent management
        let currentPlayingBaseFreq = 0; // ì„¹ì…˜ 4ì—ì„œ í˜„ì¬ ì¬ìƒ ì¤‘ì¸ ìŒì˜ ê¸°ë³¸ ì£¼íŒŒìˆ˜ë¥¼ ì €ì¥

        // initAudio í•¨ìˆ˜ë¥¼ ë¹„ë™ê¸° í•¨ìˆ˜ë¡œ ë³€ê²½
        async function initAudio() {
            console.log('initAudio called. Current AudioContext state:', audioContext ? audioContext.state : 'null');
            if (!audioContext) { // Only create context if it doesn't exist
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                gainNode = audioContext.createGain();
                gainNode.connect(audioContext.destination);
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                console.log('AudioContext created. Initial state:', audioContext.state);
            }

            // Attempt to resume if suspended or interrupted
            if (audioContext.state === 'suspended' || audioContext.state === 'interrupted') {
                console.log('Attempting to resume AudioContext from state:', audioContext.state);
                try {
                    await audioContext.resume();
                    console.log('AudioContext resumed successfully. New state:', audioContext.state);
                    // Play a very short, silent tone to keep AudioContext active on mobile
                    if (audioContext.state === 'running') {
                        const silentOscillator = audioContext.createOscillator();
                        const silentGain = audioContext.createGain();
                        silentOscillator.connect(silentGain);
                        silentGain.connect(audioContext.destination);
                        silentGain.gain.setValueAtTime(0.00001, audioContext.currentTime); // Very low volume
                        silentOscillator.start(audioContext.currentTime);
                        silentOscillator.stop(audioContext.currentTime + 0.001); // Very short duration
                        console.log('Played silent tone to keep AudioContext active.');
                    }
                } catch (e) {
                    console.error('Failed to resume AudioContext:', e);
                }
            } else if (audioContext.state === 'running') {
                console.log('AudioContext state is already active:', audioContext.state);
            }
            console.log('initAudio finished. Final AudioContext state:', audioContext.state);
        }

        // ì„ íƒëœ íŒŒí˜• íƒ€ì…ì„ ì €ì¥í•˜ëŠ” ì „ì—­ ë³€ìˆ˜
        let selectedWaveformType = 'sine'; // ê¸°ë³¸ê°’ì€ ì‚¬ì¸íŒŒ

        // Helper function to create a PeriodicWave for a square wave with variable duty cycle
        function createSquarePeriodicWave(audioContext, dutyCycle) {
            const numHarmonics = 2048; // Number of harmonics
            const real = new Float32Array(numHarmonics + 1);
            const imag = new Float32Array(numHarmonics + 1);

            real[0] = 0; // DC component
            imag[0] = 0;

            for (let k = 1; k <= numHarmonics; k++) {
                const nPiD = k * Math.PI * dutyCycle;
                real[k] = (2 / (k * Math.PI)) * Math.sin(nPiD);
                imag[k] = (2 / (k * Math.PI)) * (1 - Math.cos(nPiD));
            }
            return audioContext.createPeriodicWave(real, imag, { disableNormalization: true });
        }

        // playTone í•¨ìˆ˜ (ìˆ˜ì •ë¨)
        async function playTone(frequency, dutyCycle = 0.5) {
            console.log(`playTone: freq=${frequency}, waveform=${selectedWaveformType}, dutyCycle=${dutyCycle}, currentOscillatorType=${oscillator ? oscillator.type : 'null'}`);
            await initAudio();

            if (!audioContext || audioContext.state !== 'running') {
                console.warn('AudioContext is not running. Cannot play tone.');
                return;
            }

            let recreateOscillator = false;
            if (!oscillator) {
                recreateOscillator = true;
            } else {
                // ìš”ì²­ëœ íŒŒí˜•ê³¼ í˜„ì¬ ì˜¤ì‹¤ë ˆì´í„°ì˜ ìƒíƒœë¥¼ ë¹„êµí•˜ì—¬ ì¬ìƒì„± ì—¬ë¶€ ê²°ì •
                if (selectedWaveformType === 'square') {
                    // square(PeriodicWave)ë¥¼ ì‚¬ìš©í•˜ë ¤ëŠ”ë°, í˜„ì¬ ì˜¤ì‹¤ë ˆì´í„°ê°€ custom íƒ€ì…ì´ ì•„ë‹ˆë©´ ì¬ìƒì„±
                    if (oscillator.type !== 'custom') {
                        recreateOscillator = true;
                        console.log('Recreating oscillator: current type is not custom, but square (PeriodicWave) is requested.');
                    }
                    // ì´ë¯¸ custom íƒ€ì…ì´ë©´ (ì¦‰, PeriodicWave ì‚¬ìš© ì¤‘), dutyCycle ë³€ê²½ì„ ìœ„í•´ ì¬ìƒì„±í•  í•„ìš”ëŠ” ì—†ìŒ. setPeriodicWaveë§Œ í˜¸ì¶œ.
                } else { // sine, sawtooth, triangle
                    // í‘œì¤€ íŒŒí˜•ì„ ì‚¬ìš©í•˜ë ¤ëŠ”ë°, í˜„ì¬ ì˜¤ì‹¤ë ˆì´í„° íƒ€ì…ê³¼ ë‹¤ë¥´ë©´ ì¬ìƒì„±
                    if (oscillator.type !== selectedWaveformType) {
                        recreateOscillator = true;
                        console.log(`Recreating oscillator: current type is ${oscillator.type}, but ${selectedWaveformType} is requested.`);
                    }
                }
            }

            if (recreateOscillator) {
                if (oscillator) {
                    try {
                        oscillator.stop();
                        oscillator.disconnect();
                    } catch (e) {
                        console.warn("Error stopping/disconnecting old oscillator during recreation:", e);
                    }
                }
                oscillator = audioContext.createOscillator();
                oscillator.connect(gainNode);
                oscillator.start();
                gainNode.gain.setValueAtTime(0.5, audioContext.currentTime); // ë³¼ë¥¨ ì„¤ì •
                console.log('Oscillator (re)created and started.');
            }


            // íŒŒí˜• ì„¤ì •
            if (selectedWaveformType === 'square') {
                console.log(`Applying PeriodicWave with dutyCycle: ${dutyCycle} to oscillator (current type: ${oscillator.type})`);
                const periodicWave = createSquarePeriodicWave(audioContext, dutyCycle);
                oscillator.setPeriodicWave(periodicWave); // oscillator.type becomes 'custom'
            } else { // sine, sawtooth, triangle
                 if (oscillator.type !== selectedWaveformType) { // ì¬ìƒì„±ë˜ì§€ ì•Šì•˜ì§€ë§Œ íƒ€ì…ì´ ë‹¤ë¥¸ ê²½ìš° (ì´ë¡ ìƒ ìœ„ì—ì„œ ê±¸ëŸ¬ì§)
                    oscillator.type = selectedWaveformType;
                    console.log(`Oscillator type explicitly set to: ${selectedWaveformType}`);
                 }
            }

            if (isFinite(frequency)) {
                oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
            } else {
                console.error("Invalid frequency value:", frequency);
                stopTone(); // stopToneì´ oscillatorë¥¼ nullë¡œ ë§Œë“¦.
                return;
            }
            
            // ë³¼ë¥¨ì´ 0ìœ¼ë¡œ ë–¨ì–´ì¡Œì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì¬ìƒ ì‹œ ë‹¤ì‹œ ì„¤ì • (íŠ¹íˆ stopTone í›„ ë‹¤ì‹œ playToneë  ë•Œ)
            if (gainNode.gain.value === 0) { // gainNode.gain.valueëŠ” ìµœì‹  í¬ë¡¬ì—ì„œ ì§€ì›. êµ¬í˜• ë¸Œë¼ìš°ì €ëŠ” ë‹¤ë¥¸ ë°©ë²• í•„ìš”í•  ìˆ˜ ìˆìŒ.
                 gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
            } else { // ë¶€ë“œëŸ½ê²Œ ì˜¬ë¦¬ê¸°
                 gainNode.gain.linearRampToValueAtTime(0.5, audioContext.currentTime + 0.01);
            }


            console.log(`Playing tone. Oscillator actual type: ${oscillator.type}, Requested type: ${selectedWaveformType}, Freq: ${frequency.toFixed(2)} Hz, Duty: ${dutyCycle}`);
        }


        function stopTone() {
            console.log('stopTone called.');
            if (oscillator) {
                try {
                    if (gainNode && audioContext && audioContext.state === 'running') {
                        gainNode.gain.setValueAtTime(gainNode.gain.value, audioContext.currentTime); // í˜„ì¬ ê²Œì¸ ê°’ì—ì„œ ì‹œì‘
                        gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + 0.015); // ë” ì§§ê²Œ
                        
                        // ì´ë¯¸ ì‹¤í–‰ ì¤‘ì¸ stop() íƒ€ì´ë¨¸ê°€ ìˆë‹¤ë©´ ì·¨ì†Œ (ë³µì¡í•´ì§€ë¯€ë¡œ ì—¬ê¸°ì„  ìƒëµ, oscillator null ì²˜ë¦¬ë¡œ ëŒ€ì‘)
                        const tempOscillator = oscillator; // ì„ì‹œ ë³€ìˆ˜ì— ì €ì¥
                        oscillator = null; // ë‹¤ë¥¸ ê³³ì—ì„œ ì¤‘ë³µ í˜¸ì¶œ ë°©ì§€

                        // stopì€ í•œ ë²ˆë§Œ í˜¸ì¶œë˜ì–´ì•¼ í•¨
                        setTimeout(() => { // rampê°€ ì™„ë£Œë  ì‹œê°„ì„ ì£¼ê³  stop
                           try {
                               tempOscillator.stop();
                               tempOscillator.disconnect();
                               console.log('Oscillator stopped and disconnected after ramp.');
                           } catch(e) {console.warn("Error in scheduled stop/disconnect:", e)}
                        }, 20); // ramp ì‹œê°„ë³´ë‹¤ ì•½ê°„ ê¸¸ê²Œ

                    } else { // ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ê°€ ì—†ê±°ë‚˜ ì‹¤í–‰ ì¤‘ì´ì§€ ì•Šì€ ê²½ìš°
                        const tempOscillator = oscillator;
                        oscillator = null;
                        tempOscillator.stop();
                        tempOscillator.disconnect();
                        console.log('Oscillator stopped and disconnected (no ramp).');
                    }
                } catch (e) {
                    console.warn('Error stopping oscillator:', e);
                    if (oscillator) { // ë§Œì•½ ìœ„ì—ì„œ null ì²˜ë¦¬ê°€ ì•ˆë˜ì—ˆë‹¤ë©´ ì—¬ê¸°ì„œë¼ë„
                       try { oscillator.disconnect(); } catch (ex) {}
                       oscillator = null; // í™•ì‹¤íˆ nullë¡œ ë§Œë“¦
                    }
                }
            } else {
                console.log('stopTone called, but oscillator is already null.');
            }
        }

        const frequencySlider = document.getElementById('frequencySlider');
        const frequencyValue = document.getElementById('frequencyValue');
        const pitchDescription = document.getElementById('pitchDescription');
        let waveCanvas; 
        let waveCtx;    

        function drawWave(frequency) {
            // ìº”ë²„ìŠ¤ ì»¨í…ìŠ¤íŠ¸ê°€ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ë‹¤ë©´ í•¨ìˆ˜ ì¢…ë£Œ
            if (!waveCtx || !waveCanvas) return; 

            const width = waveCanvas.width;
            const height = waveCanvas.height;
            const amplitude = height / 3;
            const centerY = height / 2;
            
            waveCtx.clearRect(0, 0, width, height); // ìº”ë²„ìŠ¤ ì§€ìš°ê¸°
            waveCtx.beginPath(); // ìƒˆë¡œìš´ ê²½ë¡œ ì‹œì‘
            waveCtx.moveTo(0, centerY); // ì‹œì‘ì  ì„¤ì •

            // ì‚¬ì¸íŒŒ ê·¸ë¦¬ê¸°
            for (let x = 0; x < width; x++) {
                const y = centerY + amplitude * Math.sin((x * frequency * Math.PI * 2) / (width * 5));
                waveCtx.lineTo(x, y);
            }
            waveCtx.strokeStyle = 'rgb(59, 130, 246)'; // íŒŒë€ìƒ‰ ì„ 
            waveCtx.lineWidth = 2; // ì„  ë‘ê»˜
            waveCtx.stroke(); // ì„  ê·¸ë¦¬ê¸°
        }
        
        function setupWaveCanvas() {
            waveCanvas = document.getElementById('waveCanvas'); 
            if (waveCanvas) { 
                waveCtx = waveCanvas.getContext('2d'); 
                const container = waveCanvas.parentElement;
                waveCanvas.width = container.clientWidth;
                waveCanvas.height = container.clientHeight;
                drawWave(parseInt(frequencySlider.value)); // ì´ˆê¸° íŒŒí˜• ê·¸ë¦¬ê¸°
            }
        }

        frequencySlider.addEventListener('input', async (event) => { 
            const freq = parseInt(event.target.value);
            frequencyValue.textContent = freq;
            drawWave(freq); 
            if (freq < 7) pitchDescription.textContent = "ë‚®ì€ ìŒ (ì €ì£¼íŒŒ)";
            else if (freq < 14) pitchDescription.textContent = "ì¤‘ê°„ ìŒ";
            else if (freq >= 14) pitchDescription.textContent = "ë†’ì€ ìŒ (ê³ ì£¼íŒŒ)";

            const audioFreq = 100 + (freq - 1) * 50;
            // ì„¹ì…˜ 1ì—ì„œëŠ” í•­ìƒ ì‚¬ì¸íŒŒë¡œ ì†Œë¦¬ë‚´ê¸° ìœ„í•´ ì„ì‹œë¡œ selectedWaveformType ë³€ê²½
            const originalSelectedWaveformTypeForSoundPage = selectedWaveformType;
            selectedWaveformType = 'sine';
            await playTone(audioFreq, 0.5); 
            selectedWaveformType = originalSelectedWaveformTypeForSoundPage; // ì›ë˜ëŒ€ë¡œ ë³µêµ¬
        });

        frequencySlider.addEventListener('mouseup', stopTone);
        frequencySlider.addEventListener('touchend', stopTone);
        frequencySlider.addEventListener('mouseleave', stopTone);
        
        let timerAnimationCanvas, timerAnimationCtx;
        let schmittTriggerAnimationCanvas, schmittTriggerAnimationCtx; 
        let animationTime = 0;

        function drawHeartWaveform(ctx, canvas, type, time) {
            const width = canvas.width;
            const height = canvas.height;
            const amplitude = height / 3;
            const centerY = height / 2;
            const flowSpeed = 0.5; 

            ctx.clearRect(0, 0, width, height);
            ctx.beginPath();
            ctx.moveTo(0, centerY);

            for (let x = 0; x < width; x++) {
                let y;
                const angle = ((x / width) * Math.PI * 4) + (time * flowSpeed); 

                if (type === 'pulse') {
                    y = centerY + amplitude * (Math.sin(angle) > 0.8 ? 1 : -1); 
                } else if (type === 'square') {
                    y = centerY + amplitude * (Math.sin(angle) > 0 ? 1 : -1);
                }
                ctx.lineTo(x, y);
            }
            ctx.strokeStyle = 'rgb(59, 130, 246)';
            ctx.lineWidth = 2;
            ctx.stroke();
        }

        function animateHeartWaves() {
            animationTime += 0.1; 
            if (timerAnimationCtx && timerAnimationCanvas) {
                drawHeartWaveform(timerAnimationCtx, timerAnimationCanvas, 'pulse', animationTime);
            }
            if (schmittTriggerAnimationCtx && schmittTriggerAnimationCanvas) {
                drawHeartWaveform(schmittTriggerAnimationCtx, schmittTriggerAnimationCanvas, 'square', animationTime);
            }
            window.timerAnimationId = requestAnimationFrame(animateHeartWaves);
        }

        function setupHeartCanvases() {
            timerAnimationCanvas = document.getElementById('timerAnimationCanvas');
            schmittTriggerAnimationCanvas = document.getElementById('schmittTriggerAnimationCanvas');

            if (timerAnimationCanvas) {
                timerAnimationCtx = timerAnimationCanvas.getContext('2d');
                timerAnimationCanvas.width = timerAnimationCanvas.parentElement.clientWidth;
                timerAnimationCanvas.height = timerAnimationCanvas.parentElement.clientHeight;
            }
            if (schmittTriggerAnimationCanvas) {
                schmittTriggerAnimationCtx = schmittTriggerAnimationCanvas.getContext('2d');
                schmittTriggerAnimationCanvas.width = schmittTriggerAnimationCanvas.parentElement.clientWidth;
                schmittTriggerAnimationCanvas.height = schmittTriggerAnimationCanvas.parentElement.clientHeight;
            }
        }

        function startHeartAnimations() {
            setupHeartCanvases(); 
            if (window.timerAnimationId === null) { 
                animationTime = 0; 
                animateHeartWaves();
            }
            const opampAnimation = document.getElementById('opampAnimation');
            if (opampAnimation && !opampAnimation.animationInterval) { // ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€
                let lm386SignalSize = 10;
                opampAnimation.animationInterval = setInterval(() => {
                    lm386SignalSize = lm386SignalSize === 10 ? 20 : 10;
                    opampAnimation.innerHTML = `ì‹ í˜¸ ì¦í­ ì¤‘... <span style="font-size:${lm386SignalSize}px">ğŸ”Š</span>`;
                }, 750);
            }
        }

        function stopHeartAnimations() {
            if (window.timerAnimationId) { 
                cancelAnimationFrame(window.timerAnimationId); 
                window.timerAnimationId = null; 
            }
            const opampAnimation = document.getElementById('opampAnimation');
            if (opampAnimation && opampAnimation.animationInterval) {
                clearInterval(opampAnimation.animationInterval);
                opampAnimation.innerHTML = `ì‹ í˜¸ ì¦í­ ì¤‘... (ë³¼ë¥¨ ì—…!)`; 
                opampAnimation.animationInterval = null;
            }
        }

        window.addEventListener('load', async () => { 
            setupWaveCanvas();
            setupSynthCanvas();
            setupHandsCanvases(); // Added to ensure hands canvas is set up on load
            // setupSlides(); // ìŠ¬ë¼ì´ë“œ ì´ˆê¸°í™” í˜¸ì¶œì€ ì´ì œ í•„ìš” ì—†ìŠµë‹ˆë‹¤ (Canva iframe ì§ì ‘ ì„ë² ë“œ).
            showSection('sound'); 

            const mainPageOverlay = document.getElementById('main-page-overlay');
            if (mainPageOverlay) {
                mainPageOverlay.classList.remove('hidden');
            }
        });


        const potentiometerDemo = document.getElementById('potentiometerDemo');
        const potentiometerValue = document.getElementById('potentiometerValue');
        potentiometerDemo.addEventListener('input', async (event) => { 
            potentiometerValue.textContent = event.target.value;
            if (isTactOn && currentActiveSectionId === 'hands') { 
                const val = parseInt(event.target.value);
                const audioFreq = 200 + (val / 100) * 1000; 
                // Fix: Ensure selectedWaveformType is set to 'square' for this section
                const originalSelectedWaveformType = selectedWaveformType; // Save original
                selectedWaveformType = 'square'; // Force square for this section
                if (oscillator) { 
                    if (isFinite(audioFreq)) {
                        // Use the handsCurrentPulseWidth for the duty cycle
                        await playTone(audioFreq, handsCurrentPulseWidth / 100); 
                    } else {
                        console.error("Invalid audioFreq value from potentiometer:", audioFreq);
                        stopTone();
                    }
                }
                selectedWaveformType = originalSelectedWaveformType; // Restore original
            }
        });


        const tactSwitchDemo = document.getElementById('tactSwitchDemo');
        const tactSwitchStatus = document.getElementById('tactSwitchStatus');
        let isTactOn = false; 
        
        async function handleTactSwitch(on) { 
            console.log('handleTactSwitch called. on:', on, 'isTactOn:', isTactOn, 'currentActiveSectionId:', currentActiveSectionId); 
            if (on && !isTactOn && currentActiveSectionId === 'hands') { 
                isTactOn = true;
                tactSwitchStatus.textContent = 'ìŠ¤ìœ„ì¹˜ ìƒíƒœ: ì¼œì§ (ì†Œë¦¬ ì¬ìƒ!)';
                tactSwitchDemo.classList.add('bg-red-500', 'hover:bg-red-600');
                tactSwitchDemo.classList.remove('bg-sky-500', 'hover:bg-sky-600');
                
                const potVal = parseInt(potentiometerDemo.value);
                const audioFreq = 200 + (potVal / 100) * 1000;
                // Fix: Ensure selectedWaveformType is set to 'square' for this section
                const originalSelectedWaveformType = selectedWaveformType; // Save original
                selectedWaveformType = 'square'; // Force square for this section
                // Use the handsCurrentPulseWidth for the duty cycle
                await playTone(audioFreq, handsCurrentPulseWidth / 100); 
                selectedWaveformType = originalSelectedWaveformType; // Restore original

            } else if (!on && isTactOn && currentActiveSectionId === 'hands') { 
                isTactOn = false;
                tactSwitchStatus.textContent = 'ìŠ¤ìœ„ì¹˜ ìƒíƒœ: êº¼ì§ (ë§ˆìš°ìŠ¤ í´ë¦­ ë˜ëŠ” ìŠ¤í˜ì´ìŠ¤ë°” í‚¤ë¡œ ì¡°ì‘)';
                tactSwitchDemo.classList.remove('bg-red-500', 'hover:bg-red-600');
                tactSwitchDemo.classList.add('bg-sky-500', 'hover:bg-sky-600');
                stopTone(); 
            }
        }

        tactSwitchDemo.addEventListener('mousedown', (event) => {
            console.log('Tact switch mousedown event fired.'); 
            event.preventDefault(); 
            handleTactSwitch(true);
        });
        tactSwitchDemo.addEventListener('mouseup', () => handleTactSwitch(false));
        tactSwitchDemo.addEventListener('mouseleave', () => {
            if (isTactOn) handleTactSwitch(false); 
        });

        tactSwitchDemo.addEventListener('touchstart', (event) => {
            console.log('Tact switch touchstart event fired.'); 
            event.preventDefault(); 
            handleTactSwitch(true);
        }, { passive: false }); 

        tactSwitchDemo.addEventListener('touchend', () => {
            console.log('Tact switch touchend event fired.'); 
            handleTactSwitch(false);
        });
        
        let isSpaceOrEnterPressed = false; 
        document.addEventListener('keydown', (event) => {
            if (currentActiveSectionId === 'hands' && (event.key === ' ' || event.key === 'Enter') && !isSpaceOrEnterPressed) {
                event.preventDefault(); 
                isSpaceOrEnterPressed = true;
                handleTactSwitch(true);
            }
        });

        document.addEventListener('keyup', (event) => {
            if (currentActiveSectionId === 'hands' && (event.key === ' ' || event.key === 'Enter') && isSpaceOrEnterPressed) {
                isSpaceOrEnterPressed = false;
                handleTactSwitch(false);
            }
        });


        let synthPitchKnob = document.getElementById('synthPitchKnob');
        let synthPitchValue = document.getElementById('synthPitchValue');
        const synthButtons = document.querySelectorAll('.synth-button');
        let synthOutputStatus = document.getElementById('synthOutputStatus');
        let synthOutputCanvas; 
        let synthCtx;    

        const pulseWidthControl = document.getElementById('pulseWidthControl');
        const pulseWidthKnob = document.getElementById('pulseWidthKnob');
        const pulseWidthValue = document.getElementById('pulseWidthValue');
        let currentPulseWidth = 50; 
        
        function drawSynthWave(frequency, type, dutyCycle = 50) {
            if (!synthCtx || !synthOutputCanvas) return; 

            const width = synthOutputCanvas.width;
            const height = synthOutputCanvas.height;
            const amplitude = height / 3;
            const centerY = height / 2;
            
            synthCtx.clearRect(0, 0, width, height); 
            synthCtx.beginPath(); 
            synthCtx.moveTo(0, centerY); 

            const visualCycles = frequency > 0 ? Math.max(1, frequency / 150) : 2; // ìµœì†Œ 1 ì‚¬ì´í´, ì£¼íŒŒìˆ˜ê°€ ë„ˆë¬´ ë‚®ìœ¼ë©´ 2ì‚¬ì´í´
            const period = width / visualCycles; 
            const onWidth = period * (dutyCycle / 100); 

            for (let x = 0; x < width; x++) {
                let y;
                const angle = (x / width) * Math.PI * 2 * visualCycles; 

                switch (type) { 
                    case 'sine':
                        y = centerY + amplitude * Math.sin(angle);
                        break;
                    case 'square':
                        const phaseInPeriod = (x % period);
                        if (phaseInPeriod < onWidth) {
                            y = centerY - amplitude; 
                        } else {
                            y = centerY + amplitude; 
                        }
                        break;
                    case 'sawtooth':
                        y = centerY - amplitude * (angle % (2 * Math.PI) / (2 * Math.PI) * 2 - 1);
                        break;
                    case 'triangle':
                        const phase = angle % (2 * Math.PI);
                        if (phase < Math.PI) {
                            y = centerY - amplitude * (1 - (phase / Math.PI) * 2);
                        } else {
                            y = centerY - amplitude * (-1 + ((phase - Math.PI) / Math.PI) * 2);
                        }
                        break;
                    default:
                        y = centerY + amplitude * Math.sin(angle); 
                }
                synthCtx.lineTo(x, y);
            }
            synthCtx.strokeStyle = 'rgb(16, 185, 129)'; 
            synthCtx.lineWidth = 2; 
            synthCtx.stroke(); 
        }

        function setupSynthCanvas() {
            synthOutputCanvas = document.getElementById('synthOutputCanvas'); 
            if (synthOutputCanvas) { 
                synthCtx = synthOutputCanvas.getContext('2d'); 
                const container = synthOutputCanvas.parentElement;
                synthOutputCanvas.width = container.clientWidth;
                synthOutputCanvas.height = container.clientHeight;
                drawSynthWave(0, selectedWaveformType, currentPulseWidth); 
            }
        }
    
        const handsPulseWidthKnob = document.getElementById('handsPulseWidthKnob');
        const handsPulseWidthValue = document.getElementById('handsPulseWidthValue');
        let handsPulseWidthCanvas; 
        let handsPulseWidthCtx;    
        let handsCurrentPulseWidth = 50;
        let handsAnimationTime = 0;

        function drawHandsPulseWave(dutyCycle, time) {
            if (!handsPulseWidthCtx || !handsPulseWidthCanvas) {
                console.warn('handsPulseWidthCanvas or handsPulseWidthCtx is not initialized in drawHandsPulseWave.');
                return;
            }

            const width = handsPulseWidthCanvas.width;
            const height = handsPulseWidthCanvas.height;
            const amplitude = height / 3;
            const centerY = height / 2;
            const flowSpeed = 0.5;
            const visualCycles = 2;
            const totalPixelsPerCycle = width / visualCycles;
            const onWidth = totalPixelsPerCycle * (dutyCycle / 100);
            const offset = (time * flowSpeed * totalPixelsPerCycle / (2 * Math.PI)) % totalPixelsPerCycle;

            handsPulseWidthCtx.clearRect(0, 0, width, height);
            handsPulseWidthCtx.beginPath();
            const initialAdjustedX = offset % totalPixelsPerCycle;
            const initialY = (initialAdjustedX < onWidth) ? (centerY - amplitude) : (centerY + amplitude);
            handsPulseWidthCtx.moveTo(0, initialY);

            for (let x = 1; x <= width; x++) {
                const adjustedX = (x + offset) % totalPixelsPerCycle;
                const prevAdjustedX = ((x - 1) + offset) % totalPixelsPerCycle;
                const currentY = (adjustedX < onWidth) ? (centerY - amplitude) : (centerY + amplitude);
                const prevY = (prevAdjustedX < onWidth) ? (centerY - amplitude) : (centerY + amplitude);
                if (currentY !== prevY) {
                    handsPulseWidthCtx.lineTo(x, prevY);
                    handsPulseWidthCtx.lineTo(x, currentY);
                } else {
                    handsPulseWidthCtx.lineTo(x, currentY);
                }
            }

            handsPulseWidthCtx.strokeStyle = 'rgb(124, 58, 237)';
            handsPulseWidthCtx.lineWidth = 2;
            handsPulseWidthCtx.stroke();
        }

        function setupHandsCanvases() {
            handsPulseWidthCanvas = document.getElementById('handsPulseWidthCanvas');
            if (handsPulseWidthCanvas) {
                handsPulseWidthCtx = handsPulseWidthCanvas.getContext('2d');
                const container = handsPulseWidthCanvas.parentElement;
                handsPulseWidthCanvas.width = container.clientWidth;
                handsPulseWidthCanvas.height = container.clientHeight;
                drawHandsPulseWave(handsCurrentPulseWidth, handsAnimationTime);
            }
        }

        function animateHandsWaves() {
            handsAnimationTime += 0.1;
            if (handsPulseWidthCtx && handsPulseWidthCanvas) {
                drawHandsPulseWave(handsCurrentPulseWidth, handsAnimationTime);
            }
            window.handsAnimationId = requestAnimationFrame(animateHandsWaves);
        }

        function startHandsAnimations() {
            setupHandsCanvases();
            if (window.handsAnimationId === null) {
                handsAnimationTime = 0;
                animateHandsWaves();
            }
        }

        function stopHandsAnimations() {
            if (window.handsAnimationId) {
                cancelAnimationFrame(window.handsAnimationId);
                window.handsAnimationId = null;
            }
        }

        if (handsPulseWidthKnob) {
            handsPulseWidthKnob.addEventListener('input', async (event) => {
                handsCurrentPulseWidth = parseInt(event.target.value);
                handsPulseWidthValue.textContent = handsCurrentPulseWidth;
                console.log(`Hands Pulse Width Slider Input: ${handsCurrentPulseWidth}, isTactOn: ${isTactOn}, currentActiveSectionId: ${currentActiveSectionId}`);

                drawHandsPulseWave(handsCurrentPulseWidth, handsAnimationTime);

                if (isTactOn && currentActiveSectionId === 'hands') {
                    console.log('Tact switch is ON in Hands section. Updating audio with duty cycle:', handsCurrentPulseWidth / 100);
                    const originalSelectedWaveformType = selectedWaveformType;
                    selectedWaveformType = 'square';
                    const potVal = parseInt(potentiometerDemo.value);
                    const audioFreq = 200 + (potVal / 100) * 1000;
                    await playTone(audioFreq, handsCurrentPulseWidth / 100);
                    selectedWaveformType = originalSelectedWaveformType;
                }
            });
        }
        
        const noteFrequencies = {
            'C5': 523.25, 'D5': 587.33, 'E5': 659.25, 'F5': 698.46, 'G5': 783.99, 'A5': 880.00, 'B5': 987.77,
            'C4': 261.63, 'D4': 293.66, 'E4': 329.63, 'F4': 349.23, 'G4': 392.00, 'A4': 440.00, 'B4': 493.88
        };

        synthPitchKnob.addEventListener('input', async (event) => { 
            const pitch = parseInt(event.target.value);
            synthPitchValue.textContent = pitch;

            if (oscillator && currentPlayingBaseFreq !== 0) {
                const pitchMultiplier = 0.5 + (pitch / 100) * 1.5; 
                const finalFreq = currentPlayingBaseFreq * pitchMultiplier;
                if (isFinite(finalFreq)) {
                    await playTone(finalFreq, currentPulseWidth / 100); 
                } else {
                    console.error("Invalid finalFreq value:", finalFreq);
                    stopTone(); 
                    return;
                }
                
                const activeNoteButton = document.querySelector('.synth-button.ring-4');
                if (activeNoteButton) {
                    const noteFull = activeNoteButton.dataset.noteFull; 
                    const noteName = noteFull.slice(0, -1);
                    const octave = parseInt(noteFull.slice(-1));
                    const noteTextMap = { 'C': 'ë„', 'D': 'ë ˆ', 'E': 'ë¯¸', 'F': 'íŒŒ', 'G': 'ì†”', 'A': 'ë¼', 'B': 'ì‹œ' };
                    const displayNote = `${noteTextMap[noteName]}${octave - 3}`; 

                    synthOutputStatus.textContent = `${displayNote} ìŒ (${selectedWaveformType}íŒŒ) ì¬ìƒ! (ì£¼íŒŒìˆ˜: ${finalFreq.toFixed(2)} Hz)`; 
                    drawSynthWave(finalFreq, selectedWaveformType, currentPulseWidth); 
                }
            }
        });

        document.querySelectorAll('input[name="waveformType"]').forEach(radio => {
            radio.addEventListener('change', async (event) => { 
                selectedWaveformType = event.target.value;
                console.log(`Waveform changed to: ${selectedWaveformType}`);


                if (selectedWaveformType === 'square') {
                    pulseWidthControl.classList.remove('hidden');
                } else {
                    pulseWidthControl.classList.add('hidden');
                }

                if (oscillator && currentPlayingBaseFreq !== 0) { // í˜„ì¬ ì†Œë¦¬ê°€ ì¬ìƒ ì¤‘ì´ë©´ íŒŒí˜• ì¦‰ì‹œ ë³€ê²½
                    const pitch = parseInt(synthPitchKnob.value);
                    const finalFreq = currentPlayingBaseFreq * (0.5 + (pitch / 100) * 1.5);
                    await playTone(finalFreq, currentPulseWidth / 100); 
                    // ìƒíƒœ í…ìŠ¤íŠ¸ ë° íŒŒí˜•ë„ ì—…ë°ì´íŠ¸
                    const activeNoteButton = document.querySelector('.synth-button.ring-4');
                     if (activeNoteButton) {
                        const noteFull = activeNoteButton.dataset.noteFull;
                        const noteName = noteFull.slice(0, -1);
                        const octave = parseInt(noteFull.slice(-1));
                        const noteTextMap = { 'C': 'ë„', 'D': 'ë ˆ', 'E': 'ë¯¸', 'F': 'íŒŒ', 'G': 'ì†”', 'A': 'ë¼', 'B': 'ì‹œ' };
                        const displayNote = `${noteTextMap[noteName]}${octave - 3}`;
                        synthOutputStatus.textContent = `${displayNote} ìŒ (${selectedWaveformType}íŒŒ) ì¬ìƒ! (ì£¼íŒŒìˆ˜: ${finalFreq.toFixed(2)} Hz)`;
                        drawSynthWave(finalFreq, selectedWaveformType, currentPulseWidth);
                    }

                } else { // ì†Œë¦¬ê°€ ì¬ìƒ ì¤‘ì´ ì•„ë‹ˆë©´, ì‹œê°í™”ë§Œ ì—…ë°ì´íŠ¸
                    if (currentActiveSectionId === 'play') { 
                        drawSynthWave(0, selectedWaveformType, currentPulseWidth);
                    }
                }
            });
        });

        pulseWidthKnob.addEventListener('input', async (event) => { 
            currentPulseWidth = parseInt(event.target.value);
            pulseWidthValue.textContent = currentPulseWidth;

            if (oscillator && currentPlayingBaseFreq !== 0) {
                const pitch = parseInt(synthPitchKnob.value);
                const finalFreq = currentPlayingBaseFreq * (0.5 + (pitch / 100) * 1.5);
                drawSynthWave(finalFreq, selectedWaveformType, currentPulseWidth); // ì‹œê°í™”ëŠ” í•­ìƒ ì—…ë°ì´íŠ¸
                if (selectedWaveformType === 'square') { // ì‚¬ê°íŒŒì¼ ë•Œë§Œ ì˜¤ë””ì˜¤ ì—…ë°ì´íŠ¸
                    await playTone(finalFreq, currentPulseWidth / 100); 
                }
            } else {
                if (selectedWaveformType === 'square' && currentActiveSectionId === 'play') {
                     drawSynthWave(0, selectedWaveformType, currentPulseWidth); 
                }
            }
        });

        const noteHueMap = { 'C': 0, 'D': 30, 'E': 60, 'F': 120, 'G': 240, 'A': 270, 'B': 300 };
        const octaveLightness = { '5': 80, '4': 60 };
        const fixedSaturation = 80; 

        function getNoteGradient(noteFull) {
            const noteName = noteFull.slice(0, -1); 
            const octave = noteFull.slice(-1);    

            const hue = noteHueMap[noteName] || 0; 
            const lightness = octaveLightness[octave] || 70; 

            const startColor = `hsl(${hue}, ${fixedSaturation}%, ${lightness}%)`;
            const endColor = `hsl(${hue}, ${fixedSaturation}%, ${lightness - 20}%)`; 

            return `linear-gradient(to bottom, ${startColor}, ${endColor})`;
        }

        synthButtons.forEach(button => {
            const noteFull = button.dataset.noteFull;
            button.style.background = getNoteGradient(noteFull);

            button.addEventListener('mousedown', async (event) => { 
                console.log('Synth button mousedown event fired for:', button.dataset.noteFull); 
                event.preventDefault(); 
                const noteFull = button.dataset.noteFull; 
                const pitch = parseInt(synthPitchKnob.value);
                
                let baseFreq = noteFrequencies[noteFull];
                currentPlayingBaseFreq = baseFreq; 

                const pitchMultiplier = 0.5 + (pitch / 100) * 1.5; 
                const finalFreq = baseFreq * pitchMultiplier;

                document.querySelectorAll('.synth-button.ring-4').forEach(b => {
                    b.classList.remove('ring-4', 'ring-blue-500', 'scale-105');
                });
                button.classList.add('ring-4', 'ring-blue-500', 'scale-105');

                const noteName = noteFull.slice(0, -1);
                const octave = parseInt(noteFull.slice(-1));
                const noteTextMap = { 'C': 'ë„', 'D': 'ë ˆ', 'E': 'ë¯¸', 'F': 'íŒŒ', 'G': 'ì†”', 'A': 'ë¼', 'B': 'ì‹œ' };
                const displayNote = `${noteTextMap[noteName]}${octave - 3}`; 

                synthOutputStatus.textContent = `${displayNote} ìŒ (${selectedWaveformType}íŒŒ) ì¬ìƒ! (ì£¼íŒŒìˆ˜: ${finalFreq.toFixed(2)} Hz)`; 
                drawSynthWave(finalFreq, selectedWaveformType, currentPulseWidth); 
                await playTone(finalFreq, currentPulseWidth / 100); 
            });

            button.addEventListener('mouseup', () => {
                console.log('Synth button mouseup event fired for:', button.dataset.noteFull); 
                stopTone();
                button.classList.remove('ring-4', 'ring-blue-500', 'scale-105');
                synthOutputStatus.textContent = 'ë²„íŠ¼ì„ ëˆŒëŸ¬ ì—°ì£¼í•´ë³´ì„¸ìš”!';
                drawSynthWave(0, selectedWaveformType, currentPulseWidth); 
                currentPlayingBaseFreq = 0; 
            });

            button.addEventListener('mouseleave', () => {
                 console.log('Synth button mouseleave event fired.'); 
                 if (button.classList.contains('ring-4')) {
                    stopTone();
                    button.classList.remove('ring-4', 'ring-blue-500', 'scale-105');
                    synthOutputStatus.textContent = 'ë²„íŠ¼ì„ ëˆŒëŸ¬ ì—°ì£¼í•´ë³´ì„¸ìš”!';
                    drawSynthWave(0, selectedWaveformType, currentPulseWidth); 
                    currentPlayingBaseFreq = 0;
                 }
            });

            button.addEventListener('touchstart', async (event) => { 
                console.log('Synth button touchstart event fired for:', button.dataset.noteFull); 
                event.preventDefault(); 
                const noteFull = button.dataset.noteFull;
                const pitch = parseInt(synthPitchKnob.value);

                let baseFreq = noteFrequencies[noteFull];
                currentPlayingBaseFreq = baseFreq;

                const pitchMultiplier = 0.5 + (pitch / 100) * 1.5;
                const finalFreq = baseFreq * pitchMultiplier;

                document.querySelectorAll('.synth-button.ring-4').forEach(b => {
                    b.classList.remove('ring-4', 'ring-blue-500', 'scale-105');
                });
                button.classList.add('ring-4', 'ring-blue-500', 'scale-105');

                const noteName = noteFull.slice(0, -1);
                const octave = parseInt(noteFull.slice(-1));
                const noteTextMap = { 'C': 'ë„', 'D': 'ë ˆ', 'E': 'ë¯¸', 'F': 'íŒŒ', 'G': 'ì†”', 'A': 'ë¼', 'B': 'ì‹œ' };
                const displayNote = `${noteTextMap[noteName]}${octave - 3}`;
                synthOutputStatus.textContent = `${displayNote} ìŒ (${selectedWaveformType}íŒŒ) ì¬ìƒ! (ì£¼íŒŒìˆ˜: ${finalFreq.toFixed(2)} Hz)`;
                drawSynthWave(finalFreq, selectedWaveformType, currentPulseWidth);
                await playTone(finalFreq, currentPulseWidth / 100);
            }, { passive: false });

            button.addEventListener('touchend', () => {
                console.log('Synth button touchend event fired.');
                stopTone();
                button.classList.remove('ring-4', 'ring-blue-500', 'scale-105');
                synthOutputStatus.textContent = 'ë²„íŠ¼ì„ ëˆŒëŸ¬ ì—°ì£¼í•´ë³´ì„¸ìš”!';
                drawSynthWave(0, selectedWaveformType, currentPulseWidth);
                currentPlayingBaseFreq = 0;
            });
        });

        document.addEventListener('DOMContentLoaded', () => {
            const sineRadioPlay = document.querySelector('#play input[name="waveformType"][value="sine"]');
            const pulseWidthControlUI = document.getElementById('pulseWidthControl');
            if (sineRadioPlay && sineRadioPlay.checked) { // play ì„¹ì…˜ì˜ ì‚¬ì¸íŒŒê°€ ê¸°ë³¸ ì²´í¬ë˜ì–´ ìˆë‹¤ë©´
                 if(pulseWidthControlUI) pulseWidthControlUI.classList.add('hidden');
            }


            showSection(currentActiveSectionId); 
        });

        window.addEventListener('resize', () => {
            if (currentActiveSectionId === 'sound') {
                setupWaveCanvas();
                drawWave(parseInt(frequencySlider.value));
            } else if (currentActiveSectionId === 'heart') {
                setupHeartCanvases();
            } else if (currentActiveSectionId === 'hands') {
                setupHandsCanvases(); // Ensure setup is called on resize
                drawHandsPulseWave(handsCurrentPulseWidth, handsAnimationTime); 
            } else if (currentActiveSectionId === 'play') {
                setupSynthCanvas();
                const activeNoteButton = document.querySelector('.synth-button.ring-4');
                let freqToDraw = 0;
                if (activeNoteButton && currentPlayingBaseFreq !== 0) {
                    const pitch = parseInt(synthPitchKnob.value);
                    freqToDraw = currentPlayingBaseFreq * (0.5 + (pitch / 100) * 1.5);
                }
                drawSynthWave(freqToDraw, selectedWaveformType, currentPulseWidth);
            } 
            // 'summary' ì„¹ì…˜ì— ëŒ€í•œ resize í•¸ë“¤ë§ì€ iframeì´ ìì²´ì ìœ¼ë¡œ ë°˜ì‘í˜•ì„ ì²˜ë¦¬í•˜ë¯€ë¡œ ì œê±°
        });

    // --- ê¸°ì¡´ ìŠ¬ë¼ì´ë“œ ê¸°ëŠ¥ ê´€ë ¨ JavaScript ì œê±° ë˜ëŠ” ì£¼ì„ ì²˜ë¦¬ ---
    // ê¸°ì¡´ ìŠ¬ë¼ì´ë“œ ê¸°ëŠ¥ ê´€ë ¨ ë³€ìˆ˜ë“¤ì€ ì‚¬ìš©ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì œê±°í•©ë‹ˆë‹¤.
    // let currentSlide = 0;
    // const slidesContainer = document.getElementById('circuit-slides');
    // const slidePages = slidesContainer ? slidesContainer.querySelectorAll('.slide-page') : [];
    // const totalSlides = slidePages.length;
    // const prevButton = document.getElementById('prevSlide');
    // const nextButton = document.getElementById('nextSlide');
    // const slideIndicatorsContainer = document.getElementById('slideIndicators');

    // // ê¸°ì¡´ ìŠ¬ë¼ì´ë“œ ì œì–´ í•¨ìˆ˜ë“¤ì€ ì‚¬ìš©ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì œê±°í•©ë‹ˆë‹¤.
    // function showSlide(index) { /* ... */ }
    // function nextSlide() { /* ... */ }
    // function prevSlide() { /* ... */ }
    // function createIndicators() { /* ... */ }
    // function updateIndicators() { /* ... */ }

    // setupSlides í•¨ìˆ˜ëŠ” ì´ì œ í•„ìš” ì—†ìœ¼ë¯€ë¡œ ì œê±°í•©ë‹ˆë‹¤.
    // function setupSlides() {
    //     if (slidesContainer) {
    //         showSlide(currentSlide);
    //         createIndicators();
    //     }
    // }

    // ìŠ¬ë¼ì´ë“œ ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë„ ì œê±°í•©ë‹ˆë‹¤.
    // if (prevButton) { prevButton.addEventListener('click', prevSlide); }
    // if (nextButton) { nextButton.addEventListener('click', nextSlide); }

    // DOMContentLoadedì—ì„œ setupSlides í˜¸ì¶œë„ ì œê±°í•©ë‹ˆë‹¤.
    // document.addEventListener('DOMContentLoaded', setupSlides);

    </script>
</body>
</html>
